<!DOCTYPE html>
<!--
 * @name            jPulse Framework / Site / WebApp / View / Hello App Cluster Demo
 * @tagline         Multi-Server Application Clustering Examples
 * @description     Interactive demos: global notifications and collaborative todo with Redis broadcasting
 * @file            site/webapp/view/hello-app-cluster/index.shtml
 * @version         1.3.0
 * @release         2025-11-30
 * @repository      https://github.com/jpulse-net/jpulse-framework
 * @author          Peter Thoeny, https://twiki.org & https://github.com/peterthoeny/
 * @copyright       2025 Peter Thoeny, https://twiki.org & https://github.com/peterthoeny/
 * @license         BSL 1.1 -- see LICENSE file; for commercial use: team@jpulse.net
 * @genai           60%, Cursor 1.7, Claude Sonnet 4
-->
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>App Cluster Demo - {{app.site.shortName}}</title>
    {{file.include "jpulse-header.tmpl"}}
    <style>
        .local-card {
            padding-bottom: 0;
        }

        .local-status-value {
            font-size: 24px;
            font-weight: bold;
            color: #007bff;
            margin-bottom: 5px;
        }

        .local-status-value.redis-enabled {
            color: #28a745;
        }

        .local-status-value.redis-disabled {
            color: #ffc107;
        }

        .local-status-label {
            font-size: 12px;
            color: #6c757d;
            text-transform: uppercase;
            font-weight: 600;
            letter-spacing: 0.5px;
        }

        .local-comparison-header {
            background: #fbfbfb;
            margin: -20px -20px 25px -20px;
            padding: 15px 20px;
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
        }

        .local-comparison-icon {
            font-size: 32px;
            padding-right: 5px;
        }

        .local-comparison-title {
            font-size: 18px;
            font-weight: bold;
            margin: 0;
        }

        .local-comparison-subtitle {
            font-size: 14px;
            color: #6c757d;
            margin: 0;
        }
    </style>
</head>
<body>
    <div class="jp-main">
        <div style="display: none;">
            <!-- This card is automatically included in the dashboard at hello/index.shtml -->
            <!-- extract:start order=60 -->
            <a href="/hello-app-cluster/" class="jp-card-dashboard jp-icon-btn">
                <div class="jp-icon-container">{{use.jpIcons.serversSvg size="64"}}</div>
                <h3 class="jp-card-title">App Cluster Demo</h3>
                <p class="jp-card-description">Learn how to build scalable multi-server applications with Redis broadcasting</p>
            </a>
            <!-- extract:end -->
        </div>

        <div class="jp-container-1200">
            <div class="jp-page-header">
                <h1>{{use.jpIcons.serversSvg size="26"}} App Cluster Demo</h1>
                <span class="jp-subtitle">Learn how to build scalable multi-server applications with Redis broadcasting</span>
            </div>

            <!-- Sub-navigation -->
            <nav class="jp-btn-nav-group">
                <a href="/hello-app-cluster/" class="jp-btn jp-btn-outline jp-btn-active">üìñ Overview</a>
                <span class="jp-btn-nav-arrow">‚Üí</span>
                <a href="/hello-app-cluster/notifications.shtml" class="jp-btn jp-btn-outline">üì¢ Global Notifications</a>
                <span class="jp-btn-nav-arrow">‚Üí</span>
                <a href="/hello-app-cluster/collaborative-todo.shtml" class="jp-btn jp-btn-outline">‚úÖ Collaborative To-Do</a>
                <span class="jp-btn-nav-arrow">‚Üí</span>
                <a href="/hello-app-cluster/code-examples.shtml" class="jp-btn jp-btn-outline">üíª Code Examples</a>
                <span class="jp-btn-nav-arrow">‚Üí</span>
                <a href="/hello-app-cluster/architecture.shtml" class="jp-btn jp-btn-outline">üèóÔ∏è Architecture</a>
            </nav>

            <!-- Cluster Status -->
            <div class="jp-card">
                <h2 class="jp-card-dialog-heading">üñ•Ô∏è Current Cluster Status</h2>
                <div class="jp-card-subheading">This shows the current state of your jPulse Framework instance and Redis configuration.</div>

                <div class="jp-stats-grid">
                    <div class="jp-stat-card">
                        <div class="local-status-value" id="instanceId" style="font-size: 18px;">Loading...</div>
                        <div class="local-status-label">Server Instance</div>
                    </div>
                    <div class="jp-stat-card">
                        <div class="local-status-value redis-{{#if redis.enabled}}enabled{{else}}disabled{{/if}}" id="redisStatus">
                            {{#if redis.enabled}}‚úÖ Enabled{{else}}‚ö†Ô∏è Disabled{{/if}}
                        </div>
                        <div class="local-status-label">Redis Broadcasting</div>
                    </div>
                    <div class="jp-stat-card">
                        <div class="local-status-value" id="clusterMode">
                            {{#if redis.enabled}}Multi-Server{{else}}Single-Server{{/if}}
                        </div>
                        <div class="local-status-label">Cluster Mode</div>
                    </div>
                    <div class="jp-stat-card">
                        <div class="local-status-value" id="broadcastSupport">
                            {{#if redis.enabled}}Full Support{{else}}Local Only{{/if}}
                        </div>
                        <div class="local-status-label">Broadcast Support</div>
                    </div>
                </div>
            </div>

            <!-- What You'll Learn -->
            <div class="jp-info-box">
                <h3>üéì What You'll Learn</h3>
                <p>This comprehensive demo teaches you how to build applications that work seamlessly across multiple server instances using Redis broadcasting.</p>

                <div style="margin: 15px 0;">
                    <strong>Key Concepts Covered:</strong>
                    <ul style="margin: 10px 0; padding-left: 20px;">
                        <li><strong>Multi-Server Coordination:</strong> How multiple app servers communicate</li>
                        <li><strong>Redis Broadcasting:</strong> Server-to-server messaging with pub/sub</li>
                        <li><strong>Graceful Fallback:</strong> Apps work with or without Redis</li>
                        <li><strong>Two Implementation Patterns:</strong> Client-side vs server-side broadcasting</li>
                        <li><strong>Real-time Synchronization:</strong> Keep data in sync across instances</li>
                    </ul>
                </div>
            </div>

            <!-- Demo Applications Comparison -->
            <div class="jp-card local-card">
                <h2 class="jp-card-dialog-heading">üöÄ Two Demo Applications</h2>
                <div class="jp-card-subheading">We've created two complementary demos to show different broadcasting patterns.</div>

                <div class="jp-status-grid">
                    <!-- Global Notifications -->
                    <div class="jp-card">
                        <div class="local-comparison-header">
                            <div class="local-comparison-icon">üì¢</div>
                            <div>
                                <h3 class="local-comparison-title">Global Notifications</h3>
                                <p class="local-comparison-subtitle">Client-Side Broadcasting Pattern</p>
                            </div>
                        </div>

                        <p><strong>Simple & Direct:</strong> Send notifications instantly to all servers without backend logic.</p>

                        <ul class="jp-list jp-list-checkmarks">
                            <li>Pure client-side JavaScript</li>
                            <li>No server-side persistence</li>
                            <li>Instant broadcast delivery</li>
                            <li>Perfect for alerts & status updates</li>
                            <li>Great for learning basics</li>
                        </ul>

                        <a href="/hello-app-cluster/notifications.shtml" class="jp-btn jp-btn-primary" style="width: 100%; margin-top: 15px;">
                            üì¢ Try Global Notifications
                        </a>
                    </div>

                    <!-- Collaborative To-Do -->
                    <div class="jp-card">
                        <div class="local-comparison-header">
                            <div class="local-comparison-icon">‚úÖ</div>
                            <div>
                                <h3 class="local-comparison-title">Collaborative To-Do</h3>
                                <p class="local-comparison-subtitle">Server-Side Broadcasting Pattern</p>
                            </div>
                        </div>

                        <p><strong>Production-Ready:</strong> Full MVC pattern with database persistence and proper validation.</p>

                        <ul class="jp-list jp-list-checkmarks">
                            <li>Complete MVC architecture</li>
                            <li>Database persistence</li>
                            <li>Server-side validation</li>
                            <li>Audit logging included</li>
                            <li>Enterprise-ready pattern</li>
                        </ul>

                        <a href="/hello-app-cluster/collaborative-todo.shtml" class="jp-btn jp-btn-primary" style="width: 100%; margin-top: 15px;">
                            ‚úÖ Try Collaborative To-Do
                        </a>
                    </div>
                </div>
            </div>

            <!-- Getting Started -->
            <div class="jp-card">
                <h2 class="jp-card-dialog-heading">üöÄ Getting Started</h2>
                <div class="jp-card-subheading">Recommended learning path to get started with the App Cluster demo.</div>
                <p><strong>Recommended Learning Path:</strong></p>
                <ol style="padding-left: 20px;">
                    <li><strong>Start Simple:</strong> Try the <a href="/hello-app-cluster/notifications.shtml">Global Notifications</a> demo to understand basic broadcasting</li>
                    <li><strong>Go Advanced:</strong> Explore the <a href="/hello-app-cluster/collaborative-todo.shtml">Collaborative To-Do</a> for production patterns</li>
                    <li><strong>Study Code:</strong> Review the <a href="/hello-app-cluster/code-examples.shtml">Code Examples</a> to see implementation details</li>
                    <li><strong>Understand Design:</strong> Read the <a href="/hello-app-cluster/architecture.shtml">Architecture</a> documentation</li>
                </ol>

                {{#unless redis.enabled}}
                <div class="jp-alert jp-alert-warning" style="margin-top: 20px;">
                    <strong>‚ö†Ô∏è Redis Not Enabled:</strong> These demos will work in single-server mode. To see full clustering features, enable Redis in your configuration. The demos gracefully demonstrate fallback behavior!
                </div>
                {{/unless}}
            </div>

            <!-- Navigation -->
            <div class="jp-btn-nav-group">
                <a href="/" class="jp-btn jp-btn-outline">üè† Home</a>
                <span class="jp-btn-nav-arrow">‚Üí</span>
                <a href="/hello/" class="jp-btn jp-btn-outline">üåê Hello World Site Demos</a>
                <span class="jp-btn-nav-arrow">‚Üí</span>
                <a href="/hello-todo/" class="jp-btn jp-btn-outline">üìã To-Do MVC Demo</a>
                <span class="jp-btn-nav-arrow">‚Üí</span>
                <a href="/hello-vue/" class="jp-btn jp-btn-outline">üîÑ Vue.js SPA Demo</a>
                <span class="jp-btn-nav-arrow">‚Üí</span>
                <a href="/hello-websocket/" class="jp-btn jp-btn-outline">ÔøΩ WebSocket Real-Time Demo</a>
                <span class="jp-btn-nav-arrow">‚Üí</span>
                <a href="/hello-app-cluster/" class="jp-btn jp-btn-active">üåç App Cluster Demo</a>
            </div>
        </div>
    </div>

    <script>
        // Load cluster status information
        jPulse.dom.ready(() => {
            // Get cluster status from server
            fetch('/api/1/broadcast/status')
                .then(response => response.json())
                .then(data => {
                    if (data.success && data.data) {
                        const clusterData = data.data;

                        // Update instance ID
                        const instanceElement = document.getElementById('instanceId');
                        if (instanceElement) {
                            instanceElement.textContent = clusterData.instanceId || 'Unknown';
                        }

                        // Update Redis status
                        const redisElement = document.getElementById('redisStatus');
                        if (redisElement) {
                            if (clusterData.redisAvailable) {
                                redisElement.textContent = '‚úÖ Enabled';
                                redisElement.className = 'local-status-value redis-enabled';
                            } else {
                                redisElement.textContent = '‚ö†Ô∏è Disabled';
                                redisElement.className = 'local-status-value redis-disabled';
                            }
                        }

                        // Update cluster mode
                        const clusterElement = document.getElementById('clusterMode');
                        if (clusterElement) {
                            clusterElement.textContent = clusterData.redisAvailable ? 'Multi-Server' : 'Single-Server';
                        }

                        // Update broadcast support
                        const broadcastElement = document.getElementById('broadcastSupport');
                        if (broadcastElement) {
                            broadcastElement.textContent = clusterData.redisAvailable ? 'Full Support' : 'Local Only';
                        }

                        // Show toast if Redis not available
                        if (!clusterData.redisAvailable) {
                            jPulse.UI.toast.warning('‚ö†Ô∏è Redis not available - running in local-only mode. The examples will not broadcast the data');
                        }
                    }
                })
                .catch(error => {
                    console.log('Could not load cluster info:', error.message);
                    // Set fallback values
                    const instanceElement = document.getElementById('instanceId');
                    if (instanceElement) {
                        instanceElement.textContent = 'Unknown';
                    }
                });
        });
    </script>

    {{file.include "jpulse-footer.tmpl"}}
</body>
</html>
<!--
SVG icons from https://lucide.dev/icons/
  - ISC License
  - Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT).
    All other copyright (c) for Lucide are held by Lucide Contributors 2025.
-->

<!-- EOF site/webapp/view/hello-app-cluster/index.shtml -->
