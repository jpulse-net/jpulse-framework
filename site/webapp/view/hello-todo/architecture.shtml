<!DOCTYPE html>
<!--
 * @name            jPulse Framework / Site / WebApp / View / Hello To-Do / Architecture
 * @tagline         Architecture Overview of To-Do MVC Demo
 * @description     How Model, View, and Controller components connect
 * @file            site/webapp/view/hello-todo/architecture.shtml
 * @version         1.0.0-rc.1
 * @release         2025-10-22
 * @repository      https://github.com/peterthoeny/jpulse-framework
 * @author          Peter Thoeny, https://twiki.org & https://github.com/peterthoeny/
 * @copyright       2025 Peter Thoeny, https://twiki.org & https://github.com/peterthoeny/
 * @license         AGPL v3, see LICENSE file
 * @genai           60%, Cursor 1.2, Claude Sonnet 4.5
-->
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>To-Do MVC Demo - Architecture - {{app.site.shortName}}</title>
    {{file.include "jpulse-header.tmpl"}}
    <style>
        .local-flow-diagram {
            background: #f8f9fa;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            padding: 2rem;
            margin: 2rem 0;
            font-family: monospace;
            line-height: 1.8;
        }

        .local-flow-step {
            margin: 0.5rem 0;
            padding-left: 1rem;
        }

        .local-flow-arrow {
            color: #007acc;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="jp-main">
        <div class="jp-container-1000">
            <div class="jp-page-header">
                <h1>ğŸ“‹ To-Do MVC Demo</h1>
            </div>

            <!-- Sub-navigation -->
            <nav class="jp-btn-nav-group">
                <a href="/hello-todo/" class="jp-btn jp-btn-outline">ğŸ“– Overview</a>
                <span class="jp-btn-nav-arrow">â†’</span>
                <a href="/hello-todo/todo-app.shtml" class="jp-btn jp-btn-outline">âœ… To-Do App</a>
                <span class="jp-btn-nav-arrow">â†’</span>
                <a href="/hello-todo/code-examples.shtml" class="jp-btn jp-btn-outline">ğŸ’» Code Examples</a>
                <span class="jp-btn-nav-arrow">â†’</span>
                <a href="/hello-todo/architecture.shtml" class="jp-btn jp-btn-outline jp-btn-active">ğŸ—ï¸ Architecture</a>
            </nav>

            <div class="jp-card">
                <h2>ğŸ—ï¸ MVC Architecture</h2>

                <div class="jp-info-box">
                    <p>Understanding how the Model, View, and Controller work together to create a clean, maintainable application.</p>
                </div>

                <h3>ğŸ“‹ Request Flow Diagram</h3>
                <p>Here's what happens when a user adds a new to-do:</p>

                <div class="local-flow-diagram">
                    <div class="local-flow-step">
                        <strong>1. Browser (Client)</strong><br>
                        User types "Buy milk" and clicks "Add To-Do"<br>
                        JavaScript calls: <code>jPulse.api.post('/api/1/helloTodo', { title: 'Buy milk' })</code>
                    </div>
                    <div class="local-flow-arrow">â†“</div>
                    <div class="local-flow-step">
                        <strong>2. Router (routes.js)</strong><br>
                        Receives: <code>POST /api/1/helloTodo</code><br>
                        Routes to: <code>HelloTodoController.apiCreate()</code>
                    </div>
                    <div class="local-flow-arrow">â†“</div>
                    <div class="local-flow-step">
                        <strong>3. Controller (helloTodo.js)</strong><br>
                        â€¢ Extracts data from request: <code>req.body.title</code><br>
                        â€¢ Gets user info: <code>req.session.user</code><br>
                        â€¢ Calls Model: <code>HelloTodoModel.create(todoData)</code>
                    </div>
                    <div class="local-flow-arrow">â†“</div>
                    <div class="local-flow-step">
                        <strong>4. Model (model/helloTodo.js)</strong><br>
                        â€¢ Creates todo object with defaults<br>
                        â€¢ Inserts into MongoDB: <code>collection.insertOne(todo)</code><br>
                        â€¢ Returns created todo with _id
                    </div>
                    <div class="local-flow-arrow">â†‘</div>
                    <div class="local-flow-step">
                        <strong>5. Controller</strong><br>
                        â€¢ Receives todo from Model<br>
                        â€¢ Sends JSON response: <code>res.json({ success: true, data: todo })</code>
                    </div>
                    <div class="local-flow-arrow">â†‘</div>
                    <div class="local-flow-step">
                        <strong>6. Browser</strong><br>
                        â€¢ Receives success response<br>
                        â€¢ Reloads page: <code>location.reload()</code><br>
                        â€¢ New todo appears in list
                    </div>
                </div>

                <h3>ğŸ“ File Structure</h3>
                <div class="jp-source-code">
                    <pre>site/webapp/
â”œâ”€â”€ controller/
â”‚   â””â”€â”€ helloTodo.js          # Controller: Request handling & coordination
â”œâ”€â”€ model/
â”‚   â””â”€â”€ helloTodo.js          # Model: Database operations
â””â”€â”€ view/
    â””â”€â”€ hello-todo/
        â”œâ”€â”€ index.shtml        # Overview page
        â”œâ”€â”€ todo-app.shtml     # Main app (View template)
        â”œâ”€â”€ code-examples.shtml
        â””â”€â”€ architecture.shtml</pre>
                </div>

                <h3>ğŸ”„ Data Flow Patterns</h3>

                <div class="jp-card" style="background: #e3f2fd; border-left: 4px solid #2196f3;">
                    <h4 style="margin-top: 0;">Page Load (Traditional MPA)</h4>
                    <p><strong>Request:</strong> User visits <code>/hello-todo/todo-app.shtml</code></p>
                    <ol>
                        <li>Router calls <code>HelloTodoController.index()</code></li>
                        <li>Controller calls <code>HelloTodoModel.getAll(username)</code></li>
                        <li>Model queries MongoDB and returns todos array</li>
                        <li>Controller renders View with todos data</li>
                        <li>Server sends complete HTML page to browser</li>
                    </ol>
                </div>

                <div class="jp-card" style="background: #f3e5f5; border-left: 4px solid #9c27b0;">
                    <h4 style="margin-top: 0;">API Request (AJAX)</h4>
                    <p><strong>Request:</strong> User clicks "Add To-Do" button</p>
                    <ol>
                        <li>JavaScript makes AJAX POST to <code>/api/1/helloTodo</code></li>
                        <li>Controller receives JSON, calls Model</li>
                        <li>Model creates todo in MongoDB</li>
                        <li>Controller returns JSON response</li>
                        <li>JavaScript reloads page to show new todo</li>
                    </ol>
                </div>

                <h3>ğŸ¯ Key Design Principles</h3>

                <table class="jp-table">
                    <thead>
                        <tr>
                            <th>Component</th>
                            <th>Responsibility</th>
                            <th>What It Knows</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Model</strong></td>
                            <td>Data & Business Logic</td>
                            <td>MongoDB structure, validation rules, CRUD operations</td>
                        </tr>
                        <tr>
                            <td><strong>View</strong></td>
                            <td>User Interface</td>
                            <td>HTML structure, styling, Handlebars templates</td>
                        </tr>
                        <tr>
                            <td><strong>Controller</strong></td>
                            <td>Coordination</td>
                            <td>HTTP requests, routing, which Model/View to use</td>
                        </tr>
                    </tbody>
                </table>

                <h3>âœ… Benefits of MVC</h3>
                <div class="jp-card" style="background: #f1f8e9; border-left: 4px solid #689f38;">
                    <ul>
                        <li><strong>Separation of Concerns</strong> - Each component has a single responsibility</li>
                        <li><strong>Reusability</strong> - Model can be used by multiple Controllers</li>
                        <li><strong>Testability</strong> - Components can be tested independently</li>
                        <li><strong>Maintainability</strong> - Easy to find and fix bugs</li>
                        <li><strong>Team Collaboration</strong> - Different developers can work on different layers</li>
                    </ul>
                </div>

                <h3>ğŸ”€ Compare: MPA vs SPA</h3>
                <div class="jp-card" style="background: #fff3cd; border-left: 4px solid #ff6b6b;">
                    <h4 style="margin-top: 0;">This To-Do App (MPA)</h4>
                    <ul>
                        <li>âœ… Server renders complete HTML pages</li>
                        <li>âœ… Browser reloads after each action</li>
                        <li>âœ… Simple, traditional approach</li>
                        <li>âœ… Works without JavaScript enabled</li>
                        <li>âŒ Full page reload on every action</li>
                    </ul>
                </div>

                <div class="jp-card" style="background: #e8f5e9; border-left: 4px solid #4caf50; margin-top: 1rem;">
                    <h4 style="margin-top: 0;">Vue.js SPA (Single Page App)</h4>
                    <ul>
                        <li>âœ… Client renders UI dynamically</li>
                        <li>âœ… Instant UI updates, no page reloads</li>
                        <li>âœ… Smooth, app-like experience</li>
                        <li>âœ… Efficient data loading (only what changed)</li>
                        <li>âŒ More complex setup and architecture</li>
                    </ul>
                    <p class="jp-help-text">ğŸ’¡ See the <a href="/hello-vue/">Vue.js SPA Demo</a> to compare!</p>
                </div>

                <h3>ğŸ“š Next: Explore More Examples</h3>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem; margin-top: 1rem;">
                    <a href="/hello-vue/" class="jp-card" style="text-decoration: none; color: inherit; cursor: pointer;">
                        <h4 style="margin-top: 0;">ğŸ”„ Vue.js SPA</h4>
                        <p>See how a Single Page Application differs from this MPA</p>
                    </a>
                    <a href="/hello-websocket/" class="jp-card" style="text-decoration: none; color: inherit; cursor: pointer;">
                        <h4 style="margin-top: 0;">ğŸ”Œ WebSocket Real-Time</h4>
                        <p>Learn real-time communication with WebSockets</p>
                    </a>
                    <a href="/hello/" class="jp-card" style="text-decoration: none; color: inherit; cursor: pointer;">
                        <h4 style="margin-top: 0;">ğŸŒ All Examples</h4>
                        <p>Back to the examples dashboard</p>
                    </a>
                </div>
            </div>

            <!-- Navigation -->
            <div class="jp-btn-nav-group">
                <a href="/" class="jp-btn jp-btn-outline">ğŸ  Home</a>
                <span class="jp-btn-nav-arrow">â†’</span>
                <a href="/hello/" class="jp-btn jp-btn-outline">ğŸŒ Hello World Site Demos</a>
                <span class="jp-btn-nav-arrow">â†’</span>
                <a href="/hello-todo/" class="jp-btn jp-btn-active">ğŸ“‹ To-Do MVC Demo</a>
            </div>
        </div>
    </div>
    {{file.include "jpulse-footer.tmpl"}}
</body>
</html>
