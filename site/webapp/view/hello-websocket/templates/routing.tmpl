<!-- WebSocket SPA routing configuration, site/webapp/view/hello-websocket/templates/routing.tmpl -->
<!--
 * @name            jPulse Framework / Site / WebApp / View / Hello WebSocket / Templates / Routing
 * @tagline         Routing and Vue.js Logic for WebSocket Demo SPA
 * @description     This file defines the Vue.js application logic for the WebSocket demo
 * @file            site/webapp/view/hello-websocket/templates/routing.tmpl
 * @version         1.4.8
 * @release         2026-01-08
 * @repository      https://github.com/jpulse-net/jpulse-framework
 * @author          Peter Thoeny, https://twiki.org & https://github.com/peterthoeny/
 * @copyright       2025 Peter Thoeny, https://twiki.org & https://github.com/peterthoeny/
 * @license         BSL 1.1 -- see LICENSE file; for commercial use: team@jpulse.net
 * @genai           60%, Cursor 1.7, Claude Sonnet 4
-->

<script type="text/javascript">

// Hello WebSocket Demo - Vue.js Application

// NOTE: This demo uses simple hash-based routing (#overview, #emoji, etc.) to keep
// the focus on WebSocket concepts. For production apps with complex routing needs,
// see /hello-vue/ which demonstrates Vue Router with History Mode (clean URLs).

// Include all page components as JavaScript (expanded server-side)
{{file.include "hello-websocket/templates/overview.tmpl"}}
{{file.include "hello-websocket/templates/emoji-demo.tmpl"}}
{{file.include "hello-websocket/templates/todo-demo.tmpl"}}
{{file.include "hello-websocket/templates/code-examples.tmpl"}}
{{file.include "hello-websocket/templates/architecture.tmpl"}}

const { createApp } = Vue;

// Define routes (similar to hello-vue pattern)
window.helloWebSocketRoutes = [
    {
        hash: 'overview',
        component: 'Overview',
        title: 'Overview',
        icon: 'ðŸ“–',
        description: 'Real-Time WebSocket Communication'
    },
    {
        hash: 'emoji',
        component: 'EmojiDemo',
        title: 'Emoji Cursor',
        icon: 'ðŸ˜Š',
        description: 'Real-time cursor tracking demo'
    },
    {
        hash: 'todo',
        component: 'TodoDemo',
        title: 'Collaborative Todo',
        icon: 'âœ…',
        description: 'Collaborative todo list with WebSocket sync'
    },
    {
        hash: 'code',
        component: 'CodeExamples',
        title: 'Code Examples',
        icon: 'ðŸ’»',
        description: 'Copy-paste ready implementation code'
    },
    {
        hash: 'architecture',
        component: 'Architecture',
        title: 'Architecture',
        icon: 'ðŸ—ï¸',
        description: 'How everything connects'
    }
];

const HelloWebSocketApp = {
    components: {
        'overviewView': window.helloWebSocketViews.Overview,
        'emojiView': window.helloWebSocketViews.EmojiDemo,
        'todoView': window.helloWebSocketViews.TodoDemo,
        'codeView': window.helloWebSocketViews.CodeExamples,
        'architectureView': window.helloWebSocketViews.Architecture
    },
    data() {
        return {
            currentView: 'overview',
            routes: window.helloWebSocketRoutes
        };
    },

    mounted() {
        // Configure WebSocket UUID storage before any connections are made
        jPulse.ws.configure({ uuidStorage: 'session' });  // or 'local' or 'memory'

        // Set initial view from URL hash
        const hash = window.location.hash.slice(1);
        if (hash) {
            this.currentView = hash;
        }

        // Handle browser back/forward
        window.addEventListener('hashchange', () => {
            this.currentView = window.location.hash.slice(1) || 'overview';
        });
    },

    methods: {
        navigateTo(view) {
            this.currentView = view;
            window.location.hash = view;
        }
    },

    template: `
        <div>
            <!-- Navigation -->
            <nav class="jp-btn-nav-group">
                <template v-for="(route, index) in routes" :key="route.hash">
                    <button
                        @click="navigateTo(route.hash)"
                        :class="['jp-btn', 'jp-btn-outline', { 'jp-btn-active': currentView === route.hash }]"
                    >
                        {{ route.icon }} {{ route.title }}
                    </button>
                    <span v-if="index < routes.length - 1" class="jp-btn-nav-arrow">â†’</span>
                </template>
            </nav>

            <!-- Content Area - Self-contained components -->
            <div class="local-ws-content">
                <overviewView v-if="currentView === 'overview'"></overviewView>
                <emojiView v-if="currentView === 'emoji'"></emojiView>
                <todoView v-if="currentView === 'todo'"></todoView>
                <codeView v-if="currentView === 'code'"></codeView>
                <architectureView v-if="currentView === 'architecture'"></architectureView>
            </div>
        </div>
    `
};

// Initialize Vue app when DOM is ready
jPulse.dom.ready(() => {
    createApp(HelloWebSocketApp).mount('#wsApp');
});

</script>

<!-- EOF SPA routing configuration, site/webapp/view/hello-websocket/templates/routing.tmpl -->
