<!DOCTYPE html>
<!--
 * @name            jPulse Framework / Site / WebApp / View / Hello World Override Demo
 * @tagline         Demo Site View Override
 * @description     Example of how to override framework views
 * @file            site/webapp/view/hello/index.shtml
 * @version         1.4.6
 * @release         2026-01-06
 * @repository      https://github.com/jpulse-net/jpulse-framework
 * @author          Peter Thoeny, https://twiki.org & https://github.com/peterthoeny/
 * @copyright       2025 Peter Thoeny, https://twiki.org & https://github.com/peterthoeny/
 * @license         BSL 1.1 -- see LICENSE file; for commercial use: team@jpulse.net
 * @genai           60%, Cursor 1.7, Claude Sonnet 4
-->
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Site Override Demo - {{app.site.shortName}}</title>
    {{file.include "jpulse-header.tmpl"}}
</head>
<body>
    <div class="jp-main">
        {{#component "helloCards.siteOverride" order=10}}
            {{!-- This card is automatically included in the dashboard at hello/index.shtml --}}
            <a href="/hello/site-override.shtml" class="jp-card-dashboard jp-icon-btn">
                <div class="jp-icon-container">{{components.jpIcons.overrideSvg size="64"}}</div>
                <h3 class="jp-card-title">Site Override</h3>
                <p class="jp-card-description">Learn how to override the framework views</p>
            </a>
        {{/component}}

        <div class="jp-page-header">
            <h1>{{components.jpIcons.overrideSvg size="26"}} Site Override</h1>
        </div>

        <div class="jp-info-box">
            <h2>Hello from Site Override!</h2>
            <p>This page demonstrates the W-014 site override system in action.</p>
        </div>

        <div class="jp-card">
            <h3>Override Information</h3>
            <ul>
                <li><strong>Site Name:</strong> {{app.site.name}}</li>
                <li><strong>Framework Version:</strong> {{app.site.version}}</li>
                <li><strong>Custom Field:</strong> {{app.customField}}</li>
                <li><strong>Custom Flag:</strong> {{#if app.customFlag}}‚úÖ Enabled{{else}}‚ùå Disabled{{/if}}</li>
                <li><strong>Override Type:</strong> Site Controller + View</li>
            </ul>
        </div>

        <div class="jp-card">
            <h3>How This Works</h3>
            <p>This page is served by:</p>
            <ol>
                <li><code>site/webapp/controller/hello.js</code> (overrides framework controller)</li>
                <li><code>site/webapp/view/hello/index.shtml</code> (overrides framework view)</li>
                <li>Configuration merged from <code>site/webapp/app.conf</code></li>
            </ol>
        </div>

        <div class="jp-card">
            <h3>Path Resolution Priority</h3>
            <ol>
                <li>ü•á <strong>site/webapp/</strong> (highest priority - this file!)</li>
                <li>ü•à <strong>webapp/</strong> (framework fallback)</li>
                <li>‚ùå Error if neither found</li>
            </ol>
        </div>

        {{#if user.isAuthenticated}}
        <div class="jp-info-box">
            <p>üëã Hello {{user.firstName}}! You're seeing this as an authenticated user.</p>
        </div>
        {{else}}
        <div class="jp-info-box">
            <p>üë§ You're viewing this as a guest. <a href="/auth/login.shtml">Sign in</a> to see personalized content.</p>
        </div>
        {{/if}}

        <div class="jp-card">
            <h3>Live API Demo</h3>
            <p>Click the button below to test the site override API using jPulse.api.call():</p>
            <button id="testApiBtn" class="jp-btn jp-btn-secondary">Test Site API</button>
            <div id="apiResponse" style="margin-top: 15px; padding: 10px; background: #f5f5f5; border-radius: 4px; display: none;">
                <strong>API Response:</strong>
                <pre id="apiResponseContent" style="margin: 10px 0; white-space: pre-wrap;"></pre>
            </div>
        </div>

        <!-- W-047: Site-Specific Development Demo -->
        <div class="jp-card">
            <h3>üé® W-047: Site-Specific Development</h3>
            <p>This page demonstrates the site override system with clean separation between framework and site code.</p>

            <div class="jp-info-box">
                <h4>Site Customization Features:</h4>
                <ul>
                    <li><strong>CSS Styling:</strong> Site-specific styles with <code>site-*</code> prefix</li>
                    <li><strong>JavaScript Extensions:</strong> Extends <code>jPulse</code> framework object</li>
                    <li><strong>Automatic Loading:</strong> No configuration required</li>
                    <li><strong>Template System:</strong> Copy templates and customize</li>
                </ul>
            </div>

            <div class="jp-actions">
                <a href="/api/1/hello" class="jp-btn jp-btn-outline" target="_blank">View Raw API Response</a>
                <a href="/jpulse-docs/" class="jp-btn jp-btn-outline" target="_blank">üìñ Read Documentation</a>
            </div>
        </div>

        <!-- Navigation -->
        <div class="jp-btn-nav-group">
            <a href="/" class="jp-btn jp-btn-outline">üè† Home</a>
            <span class="jp-btn-nav-arrow">‚Üí</span>
            <a href="/hello/" class="jp-btn jp-btn-active">üåê Hello World Site Demos</a>
        </div> 

        <script>
            jPulse.dom.ready(() => {
                // Original API test functionality
                const testBtn = document.getElementById('testApiBtn');
                const responseDiv = document.getElementById('apiResponse');
                const responseContent = document.getElementById('apiResponseContent');

                testBtn.addEventListener('click', async function() {
                    testBtn.disabled = true;
                    testBtn.textContent = 'Testing...';
                    responseDiv.style.display = 'none';

                    try {
                        // Use jPulse.api.call to test the site override API
                        const response = await jPulse.api.call('/api/1/hello', 'GET');

                        responseDiv.style.display = 'block';
                        responseContent.textContent = JSON.stringify(response, null, 2);
                        responseDiv.style.background = '#e8f5e8'; // Success green

                    } catch (error) {
                        responseDiv.style.display = 'block';
                        responseContent.textContent = `Error: ${error.message}`;
                        responseDiv.style.background = '#ffebee'; // Error red
                    }

                    testBtn.disabled = false;
                    testBtn.textContent = 'Test Site API';
                });

                // Simple demonstration that site JavaScript is loaded
                setTimeout(() => {
                    if (typeof jPulse.site !== 'undefined') {
                        console.log('‚úÖ Site JavaScript loaded successfully:', jPulse.site.config.name);
                    } else {
                        console.warn('‚ö†Ô∏è Site JavaScript not loaded');
                    }
                }, 100);
            });
        </script>
    </div>

    {{file.include "jpulse-footer.tmpl"}}
</body>
</html>
<!--
SVG icons from https://lucide.dev/icons/
  - ISC License
  - Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT).
    All other copyright (c) for Lucide are held by Lucide Contributors 2025.
-->

<!-- EOF site/webapp/view/hello/index.shtml -->
