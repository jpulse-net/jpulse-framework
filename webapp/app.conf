/**
 * @name            jPulse Framework / WebApp / Configuration
 * @tagline         WebApp for jPulse Framework
 * @description     This is the configuration file for the jPulse Framework WebApp
 * @file            webapp/app.conf
 * @version         0.9.4
 * @release         2025-10-09
 * @repository      https://github.com/peterthoeny/jpulse-framework
 * @author          Peter Thoeny, https://twiki.org & https://github.com/peterthoeny/
 * @copyright       2025 Peter Thoeny, https://twiki.org & https://github.com/peterthoeny/
 * @license         AGPL v3, see LICENSE file
 * @genai           60%, Cursor 1.2, Claude Sonnet 4
 */

// below configuration is available in the global appConfig object.
// the structure matches the file structure with controllers, views, etc.
{
    app: {
        version:        '0.9.4',
        release:        '2025-10-09',
        name:           'jPulse Framework',
        shortName:      'jPulse',
        siteId:         'jpulse-framework',
        domainName:     'localhost',
        copyright:      'Â© 2025 {{app.name}}',
        dirName:        '' // updated by app.js with __dirname
    },
    deployment: {
        mode:           'dev',
        dev: {
            name:       'development',
            db:         'jp-dev',
            port:       8080
        },
        prod: {
            name:       'production',
            db:         'jp-prod',
            port:       8081
        }
    },
    database: {
        mode:           'standalone',
        standalone: {
            url:        'mongodb://localhost:27017/%DB%', // %DB% is deployment[mode].db
            options: {
                // Authentication (uncomment and configure when needed)
                // authSource: '%DB%', // %DB% is deployment[mode].db
                // auth: {
                //     username: 'fixme',
                //     password: 'fixme'
                // },
                serverSelectionTimeoutMS: 5000,
                socketTimeoutMS:        45000,
                connectTimeoutMS:       20000,
                maxPoolSize:            10,
                minPoolSize:            1,
                maxIdleTimeMS:          30000
            }
        },
        replicaSet: {
            servers: [
                'app-001.ca.example.com:20017',
                'app-002.ca.example.com:20017',
                'app-003.ca.example.com:20017'
            ],
            url:        'mongodb://%SERVERS%/%DB%?replicaSet=app-rs', // %SERVERS% is replicaSet.servers
            options: {
                // Authentication (uncomment and configure when needed)
                // authSource: '%DB%', // %DB% is deployment[mode].db
                // auth: {
                //     username: 'fixme',
                //     password: 'fixme'
                // },
                serverSelectionTimeoutMS: 5000,
                socketTimeoutMS:        45000,
                connectTimeoutMS:       20000,
                maxPoolSize:            10,
                minPoolSize:            1,
                maxIdleTimeMS:          30000
            }
        }
    },
    redis: {
        // Redis pub/sub for multi-instance WebSocket coordination
        // Enable when running in PM2 cluster mode for horizontal scaling
        // Requires: W-076 (redis caching infrastructure)
        enabled:            false,
        host:               'localhost',
        port:               6379,
        // Optional authentication
        // password:         'fixme',
        // db:               0
    },
    middleware: {
        cors: {
            origin:         '*',
            methods:        'GET,HEAD,PUT,PATCH,POST,DELETE',
            preflightContinue:      false,
            optionsSuccessStatus:   204
        },
        bodyParser: {
            urlencoded: {
                extended:   true,
                limit:      '10mb'
            },
            json: {
                limit:      '10mb'
            }
        },
        session: {
            secret:             'fixme',
            resave:             false,
            saveUninitialized:  false,
            touchAfter:         24 * 3600,  // 24 hours in seconds
            cookie: {
                secure:         false,
                maxAge:         3600000
            }
        }
    },
    i18n: {
        default:                'en'
    },
    model: {
        user: {
            passwordPolicy: {
                minLength:      8
            }
        }
    },
    controller: {
        auth: {
            mode:               'internal',
            disableLogin:       false,  // see also view.auth.hideLogin, controller.user.disableSignup
            internal: {
            },
            ldap: {
                url:            'ldap://localhost:389',
                baseDN:         'dc=example,dc=com',
                bindPass:       'fixme',
                tls: false,
                tlsOptions: {
                    rejectUnauthorized: false,
                    ca:         []
                }
            },
            oauth2: {
                clientID:       'fixme',
                clientSecret:   'fixme',
                redirectURI:    'http://localhost:3000/oauth2/callback'
            }
        },
        log: {
            maxMsgLength:       256
        },
        markdown: {
            cacheFiles:         true,
            titleCaseFix: {     // fix 'Title Case' in _extractTitle() substitution
                Api:            'API',
                CHANGELOG:      'Version History',
                Css:            'CSS',
                Faq:            'FAQ',
                Html:           'HTML',
                Javascript:     'JavaScript',
                Jpulse:         'jPulse',
                Mvc:            'MVC',
                Mpa:            'MPA',
                Spa:            'SPA',
                Sql:            'SQL',
                Ui:             'UI',
                Vs:             'vs.'
            }
        },
        user: {
            disableSignup:      true,  // see also view.auth.hideSignup, controller.auth.disableLogin
        },
        view: {
            defaultTemplate:    'index.shtml',
            maxIncludeDepth:    10,
            cacheTemplateFiles: true,
            cacheIncludeFiles:  true
        }
    },
    view: {
        // Note: Site navigation is defined in webapp/view/jpulse-navigation.tmpl

        pageDecoration: {
            headerHeight:           35,
            showSiteNavigation:     true,   // show site nav pull-down menu on hover over home icon
            showBreadcrumbs:        true,   // show breadcrumbs at top of page
            showSidebar:            false,  // FIXME W-068: show sidebar on the left
        },
        mainContainer: {
            maxWidth:               1200,   // max width of the content area
            minMarginLeftRight:     20      // min margin left & right for narrow content area
        },
        toastMessage: {                     // non-blocking slide-down message system
            minWidth:               200,
            maxWidth:               800,
            minMarginLeftRight:     20,     // min margin left & right for narrow container
            duration: {                     // duration by type in ms
                info:               3000,
                warning:            5000,
                error:              6000,
                success:            3000,
            }
        },
        auth: {
            hideSignup:             false,  // see also controller.auth.disableSignup
            hideLogin:              false,  // see also controller.auth.disableLogin
        }
    }
}

// EOF webapp/app.conf
