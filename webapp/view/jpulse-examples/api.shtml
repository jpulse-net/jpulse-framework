<!DOCTYPE html>
<!--
 * @name            jPulse Framework / WebApp / View / jPulse Examples / API Integration
 * @tagline         API integration examples and patterns
 * @description     Comprehensive examples of API integration, data handling, and dynamic UX in jPulse
 * @file            webapp/view/jpulse-examples/api.shtml
 * @version         1.6.1
 * @release         2026-01-28
 * @repository      https://github.com/jpulse-net/jpulse-framework
 * @author          Peter Thoeny, https://twiki.org & https://github.com/peterthoeny/
 * @copyright       2025 Peter Thoeny, https://twiki.org & https://github.com/peterthoeny/
 * @license         BSL 1.1 -- see LICENSE file; for commercial use: team@jpulse.net
 * @genai           60%, Cursor 2.2, Claude Sonnet 4.5
-->
<html {{appConfig.system.htmlAttrs}}>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API Integration Examples - {{app.jPulse.shortName}}</title>
    {{file.include "jpulse-header.tmpl"}}
    <style>
        .local-heading-2 {
            margin-top: 2rem;
        }

        .local-loading-spinner {
            padding: 40px;
        }

        .local-spinner {
            display: inline-block;
            width: 40px;
            height: 40px;
            border: 4px solid var(--jp-theme-border-light, #f3f3f3);
            border-top: 4px solid var(--jp-theme-color-primary, #007acc);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        .local-loading-note {
            margin-top: 15px;
            color: var(--jp-theme-text-secondary, #666);
        }
    </style>
</head>
<body>
    {{#component "exampleCards.api" order=10}}
        {{!-- This card is automatically included in the dashboard at jpulse-examples/index.shtml --}}
        <a href="/jpulse-examples/api.shtml" class="jp-card-dashboard jp-icon-btn">
            <div class="jp-icon-container">{{components.jpIcons.apiSvg size="64"}}</div>
            <h3 class="jp-card-title">API Integration</h3>
            <p class="jp-card-description">Discover API calls, data handling, and dynamic user experiences.</p>
        </a>
    {{/component}}

    <div class="jp-main">
        <!-- Navigation Tabs -->
        <div id="jpulse-docs-examples-tabs" class="jp-tabs"></div>
        <div id="jpulse-examples-sub-tabs" class="jp-tabs"></div>

        <h1 class="jp-title">{{components.jpIcons.apiSvg size="26"}} API Integration Examples</h1>

        <div class="jp-info-box">
            <p>Learn how to integrate with APIs, handle data, and create dynamic user experiences using jPulse's built-in utilities and patterns.</p>
            <p><strong>üìñ Documentation:</strong> <a href="/jpulse-docs/api-reference">REST API Reference</a> - Complete API documentation with endpoints, authentication, and response formats.</p>
        </div>

        <!-- Basic API Call -->
        <h2 class="local-heading-2">1. Basic API Call with jPulse.api.call</h2>
        <div id="basic-api-tabs" class="jp-tabs"></div>
        <div id="basic-api-example-panel" class="jp-panel">
            <div class="jp-info-box">
                <p><strong>What you learn:</strong> How to use <code>jPulse.api.call()</code> for consistent API handling with proper success/error feedback and user notifications.</p>
                <p><strong>Test API Call:</strong> Calls <code>/api/1/health/status</code> (working endpoint) and shows green success message.</p>
                <p><strong>Test Error Handling:</strong> Calls <code>/api/1/does-not-exist</code> and shows a red error message with proper user feedback.</p>
            </div>

            <p><strong>Try the buttons below:</strong></p>

            <button id="testApiBtn" class="jp-btn jp-btn-primary">Test API Call</button>
            <button id="testErrorBtn" class="jp-btn jp-btn-danger">Test Error Handling</button>

            <div id="apiResponse" class="jp-output jp-mt-15 jp-hidden">
                <strong>API Response:</strong>
                <pre id="apiResponseContent" class="jp-pre"></pre>
            </div>
        </div>
        <div id="basic-api-source-panel" class="jp-panel">
            <div class="jp-source-code" data-lang="html">
&lt;button id="testApiBtn" class="jp-btn jp-btn-primary"&gt;Test API Call&lt;/button&gt;
&lt;button id="testErrorBtn" class="jp-btn jp-btn-danger"&gt;Test Error Handling&lt;/button&gt;

&lt;div id="apiResponse" class="jp-output jp-hidden"&gt;
    &lt;strong&gt;API Response:&lt;/strong&gt;
    &lt;pre id="apiResponseContent" class="jp-pre"&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;script&gt;
document.getElementById('testApiBtn').addEventListener('click', async () =&gt; {
    // Use jPulse.api.call for consistent API handling
    const responseDiv = document.getElementById('apiResponse');
    const responseContent = document.getElementById('apiResponseContent');
    try {
        const response = await jPulse.api.call('/api/1/health/status', 'GET');
        responseDiv.style.display = 'block';
        responseDiv.style.background = '#e8f5e8';
        responseContent.textContent = JSON.stringify(response, null, 2);

        // Handle response success/error
        if (response.success) {
            jPulse.UI.toast.success('API call successful!');
        } else {
            responseDiv.style.background = '#ffebee';
            jPulse.UI.toast.error('API returned an error: ' + response.error);
        }
    } catch (error) {
        responseDiv.style.display = 'block';
        responseDiv.style.background = '#ffebee';
        responseContent.textContent = `Error: ${error.message}`;
        jPulse.UI.toast.error('API call failed: ' + error.message);
    }
});
&lt;/script&gt;
            </div>
        </div>

        <!-- Loading States and UX -->
        <h2 class="local-heading-2">2. Loading States and User Feedback</h2>
        <div id="loading-states-tabs" class="jp-tabs"></div>
        <div id="loading-states-example-panel" class="jp-panel">
            <div class="jp-info-box">
                <p><strong>What you learn:</strong> How to implement proper loading states and user feedback during API calls for excellent user experience.</p>
                <p><strong>Features:</strong> Button loading state, spinner animation, content replacement, and success feedback.</p>
                <p><strong>Best Practice:</strong> Always show loading indicators for operations that take more than 200ms.</p>
            </div>

            <p><strong>Click to simulate a 3-second API call:</strong></p>

            <button id="loadingTestBtn" class="jp-btn jp-btn-secondary">
                <span class="btn-text">Simulate Long API Call</span>
                <span class="btn-loading jp-hidden">Loading...</span>
            </button>

            <div id="loadingDemo" class="jp-my-20">
                <div id="loadingContent" class="jp-hidden">
                    <div class="jp-info-box">
                        <h4>Loaded Data</h4>
                        <p>This content was "loaded" from an API call.</p>
                        <ul id="loadedList">
                            <!-- Content will be populated by JavaScript -->
                        </ul>
                    </div>
                </div>

                <div id="loadingSpinner" class="jp-hidden jp-text-center local-loading-spinner">
                    <div class="local-spinner"></div>
                    <p class="local-loading-note">Loading data...</p>
                </div>
            </div>
        </div>
        <div id="loading-states-source-panel" class="jp-panel">
            <div class="jp-source-code" data-lang="html">
&lt;button id="loadingTestBtn" class="jp-btn jp-btn-secondary"&gt;
    &lt;span class="btn-text"&gt;Simulate Long API Call&lt;/span&gt;
    &lt;span class="btn-loading" style="display: none;"&gt;Loading...&lt;/span&gt;
&lt;/button&gt;

&lt;div id="loadingSpinner" style="display: none;"&gt;
    &lt;div class="spinner"&gt;&lt;/div&gt;
    &lt;p&gt;Loading data...&lt;/p&gt;
&lt;/div&gt;

&lt;script&gt;
document.getElementById('loadingTestBtn').addEventListener('click', async () =&gt; {
    const btn = document.getElementById('loadingTestBtn');
    const btnText = btn.querySelector('.btn-text');
    const btnLoading = btn.querySelector('.btn-loading');
    const spinner = document.getElementById('loadingSpinner');
    const content = document.getElementById('loadingContent');

    // Show loading state
    btn.disabled = true;
    btnText.style.display = 'none';
    btnLoading.style.display = 'inline';
    spinner.style.display = 'block';
    content.style.display = 'none';

    try {
        // Simulate API delay
        await new Promise(resolve =&gt; setTimeout(resolve, 3000));

        // Simulate successful response
        const data = await simulateApiCall();

        // Hide loading, show content
        spinner.style.display = 'none';
        content.style.display = 'block';

        // Populate content
        populateContent(data);

        jPulse.UI.toast.success('Data loaded successfully!');
    } catch (error) {
        spinner.style.display = 'none';
        jPulse.UI.toast.error('Failed to load data: ' + error.message);
    } finally {
        // Reset button state
        btn.disabled = false;
        btnText.style.display = 'inline';
        btnLoading.style.display = 'none';
    }
});

async function simulateApiCall() {
    // Simulate API response
    return {
        items: ['Item 1', 'Item 2', 'Item 3'],
        timestamp: new Date().toISOString()
    };
}
&lt;/script&gt;

&lt;!-- CSS for spinner animation --&gt;
&lt;style&gt;
@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

.spinner {
    display: inline-block;
    width: 40px;
    height: 40px;
    border: 4px solid #f3f3f3;
    border-top: 4px solid #007acc;
    border-radius: 50%;
    animation: spin 1s linear infinite;
}
&lt;/style&gt;
            </div>
        </div>

        <!-- Form Data Submission -->
        <h2 class="local-heading-2">3. Form Data Submission</h2>
        <div id="form-submission-tabs" class="jp-tabs"></div>
        <div id="form-submission-example-panel" class="jp-panel">
            <div class="jp-info-box">
                <p><strong>What you learn:</strong> How to collect form data, validate it, and submit it via API with proper user feedback and loading states.</p>
                <p><strong>Demo Mode:</strong> This simulates form submission - no real data is sent to a server.</p>
                <p><strong>Features:</strong> Form validation, loading states, success feedback, and form reset after submission.</p>
            </div>

            <p><strong>Fill out and submit the form below:</strong></p>

            <form id="apiForm" class="jp-form">
                <div class="jp-form-group">
                    <label for="api-name">Name</label>
                    <input type="text" id="api-name" name="name" class="jp-form-input" required>
                </div>

                <div class="jp-form-group">
                    <label for="api-email">Email</label>
                    <input type="email" id="api-email" name="email" class="jp-form-input" required>
                </div>

                <div class="jp-form-group">
                    <label for="api-message">Message</label>
                    <textarea id="api-message" name="message" class="jp-form-input" rows="4" required></textarea>
                </div>

                <button type="submit" class="jp-btn jp-btn-primary" id="submitBtn">
                    <span class="submit-text">Submit Form</span>
                    <span class="submit-loading jp-hidden">Submitting...</span>
                </button>
            </form>

            <div id="submissionResult" class="jp-mt-15 jp-hidden">
                <div class="jp-info-box">
                    <h4>Submission Result</h4>
                    <pre id="submissionData" class="jp-pre"></pre>
                </div>
            </div>
        </div>
        <div id="form-submission-source-panel" class="jp-panel">
            <div class="jp-source-code" data-lang="html">
&lt;form id="apiForm" class="jp-form"&gt;
    &lt;div class="jp-form-group"&gt;
        &lt;label for="api-name"&gt;Name&lt;/label&gt;
        &lt;input type="text" id="api-name" name="name" class="jp-form-input" required&gt;
    &lt;/div&gt;

    &lt;button type="submit" class="jp-btn jp-btn-primary"&gt;Submit Form&lt;/button&gt;
&lt;/form&gt;

&lt;script&gt;
document.getElementById('apiForm').addEventListener('submit', async (e) =&gt; {
    e.preventDefault();

    const submitBtn = document.getElementById('submitBtn');
    const submitText = submitBtn.querySelector('.submit-text');
    const submitLoading = submitBtn.querySelector('.submit-loading');

    // Show loading state
    submitBtn.disabled = true;
    submitText.style.display = 'none';
    submitLoading.style.display = 'inline';

    try {
        // Collect form data
        const formData = new FormData(e.target);
        const data = Object.fromEntries(formData.entries());

        // NOTE: In a real application, you would implement the /api/1/contact endpoint
        // For this demo, we'll simulate the API call

        // Simulate API delay
        await new Promise(resolve =&gt; setTimeout(resolve, 2000));

        // Mock successful response
        const response = {
            success: true,
            message: 'Contact form submitted (DEMO)',
            data: { ...data, id: Math.floor(Math.random() * 10000) },
            timestamp: new Date().toISOString()
        };

        jPulse.UI.toast.success('Form submitted successfully! (Demo mode)');
        e.target.reset(); // Clear form
        displaySubmissionResult(response);
    } catch (error) {
        jPulse.UI.toast.error('Network error: ' + error.message);
    } finally {
        // Reset button state
        submitBtn.disabled = false;
        submitText.style.display = 'inline';
        submitLoading.style.display = 'none';
    }
});

function displaySubmissionResult(data) {
    const resultDiv = document.getElementById('submissionResult');
    const resultData = document.getElementById('submissionData');

    resultDiv.style.display = 'block';
    resultData.textContent = JSON.stringify(data, null, 2);
}
&lt;/script&gt;
            </div>
        </div>

        <!-- Error Handling Patterns -->
        <h2 class="local-heading-2">4. Error Handling Patterns</h2>
        <div id="error-handling-tabs" class="jp-tabs"></div>
        <div id="error-handling-example-panel" class="jp-panel">
            <div class="jp-info-box">
                <p><strong>What you learn:</strong> How to handle different types of API errors gracefully with user-friendly messages and recovery options.</p>
                <p><strong>Error Types:</strong> 404 Not Found, 500 Server Error, Network Failures, and Timeouts.</p>
                <p><strong>Best Practice:</strong> Always provide clear, user-friendly error messages and recovery options.</p>
            </div>

            <p><strong>Click buttons to simulate different error types:</strong></p>

            <div class="jp-btn-group">
                <button id="test404Btn" class="jp-btn jp-btn-warning">Test 404 Error</button>
                <button id="test500Btn" class="jp-btn jp-btn-danger">Test Server Error</button>
                <button id="testNetworkBtn" class="jp-btn jp-btn-secondary">Test Network Error</button>
                <button id="testTimeoutBtn" class="jp-btn jp-btn-info">Test Timeout</button>
            </div>

            <div id="errorDetails" class="jp-mt-15 jp-hidden">
                <div class="jp-error-box">
                    <h4>Error Details</h4>
                    <pre id="errorContent" class="jp-pre"></pre>
                </div>
            </div>
        </div>
        <div id="error-handling-source-panel" class="jp-panel">
            <div class="jp-source-code" data-lang="js">
&lt;script&gt;
async function handleApiCall(url, options = {}) {
    try {
        const response = await jPulse.api.call(url, 'GET', null, options);
        return response;
    } catch (error) {
        // Categorize and handle different error types
        if (error.name === 'TypeError' && error.message.includes('fetch')) {
            // Network error
            jPulse.UI.toast.error('Network connection failed. Please check your internet connection.');
            throw new Error('NETWORK_ERROR');
        } else if (error.status === 404) {
            // Not found error
            jPulse.UI.toast.error('The requested resource was not found.');
            throw new Error('NOT_FOUND');
        } else if (error.status >= 500) {
            // Server error
            jPulse.UI.toast.error('Server error occurred. Please try again later.');
            throw new Error('SERVER_ERROR');
        } else if (error.status === 408 || error.name === 'AbortError') {
            // Timeout error
            jPulse.UI.toast.error('Request timed out. Please try again.');
            throw new Error('TIMEOUT_ERROR');
        } else {
            // Generic error
            jPulse.UI.toast.error('An unexpected error occurred: ' + error.message);
            throw error;
        }
    }
}

// Usage with retry logic
async function apiCallWithRetry(url, maxRetries = 3) {
    for (let attempt = 1; attempt &lt;= maxRetries; attempt++) {
        try {
            return await handleApiCall(url);
        } catch (error) {
            if (attempt === maxRetries) {
                throw error; // Final attempt failed
            }

            // Wait before retry (exponential backoff)
            const delay = Math.pow(2, attempt) * 1000;
            await new Promise(resolve =&gt; setTimeout(resolve, delay));

            console.log(`- jPulse-examples: Retrying API call (attempt ${attempt + 1}/${maxRetries})...`);
        }
    }
}

// Timeout wrapper
function withTimeout(promise, timeoutMs = 10000) {
    return Promise.race([
        promise,
        new Promise((_, reject) =&gt;
            setTimeout(() =&gt; reject(new Error('Request timeout')), timeoutMs)
        )
    ]);
}
&lt;/script&gt;
            </div>
        </div>

        <!-- Real-time Data Updates -->
        <h2 class="local-heading-2">5. Real-time Data Updates</h2>
        <div id="realtime-tabs" class="jp-tabs"></div>
        <div id="realtime-example-panel" class="jp-panel">
            <div class="jp-info-box">
                <p><strong>What you learn:</strong> How to implement real-time data updates using polling techniques for live dashboards and monitoring applications.</p>
                <p><strong>Features:</strong> Automatic polling, start/stop controls, update history, and error handling.</p>
                <p><strong>Use Cases:</strong> Live dashboards, status monitoring, chat applications, and real-time analytics.</p>
            </div>

            <p><strong>Control the real-time updates:</strong></p>

            <div class="jp-btn-group">
                <button id="startPollingBtn" class="jp-btn jp-btn-success">Start Updates</button>
                <button id="stopPollingBtn" class="jp-btn jp-btn-danger" disabled>Stop Updates</button>
            </div>

            <div id="realtimeData" class="jp-mt-15">
                <div class="jp-info-box">
                    <h4>Live Data <span id="updateStatus" class="jp-text-secondary">(Stopped)</span></h4>
                    <p><strong>Last Update:</strong> <span id="lastUpdate">Never</span></p>
                    <p><strong>Update Count:</strong> <span id="updateCount">0</span></p>
                    <p><strong>Random Value:</strong> <span id="randomValue">-</span></p>
                    <div id="dataHistory" class="jp-scroll-box jp-mt-15">
                        <small>Update history will appear here...</small>
                    </div>
                </div>
            </div>
        </div>
        <div id="realtime-source-panel" class="jp-panel">
            <div class="jp-source-code" data-lang="js">
&lt;script&gt;
class RealtimeDataManager {
    constructor() {
        this.pollingInterval = null;
        this.updateCount = 0;
    }

    startPolling(intervalMs = 2000) {
        if (this.pollingInterval) {
            this.stopPolling();
        }

        this.pollingInterval = setInterval(async () =&gt; {
            try {
                await this.fetchAndUpdateData();
            } catch (error) {
                console.error('- jPulse-examples: Polling error:', error);
                this.handlePollingError(error);
            }
        }, intervalMs);

        // Initial fetch
        this.fetchAndUpdateData();
    }

    stopPolling() {
        if (this.pollingInterval) {
            clearInterval(this.pollingInterval);
            this.pollingInterval = null;
        }
    }

    async fetchAndUpdateData() {
        // Simulate API call
        const data = await this.simulateApiCall();
        this.updateUI(data);
        this.updateCount++;
    }

    async simulateApiCall() {
        // Simulate network delay
        await new Promise(resolve =&gt; setTimeout(resolve, 200));

        return {
            timestamp: new Date().toISOString(),
            value: Math.floor(Math.random() * 1000),
            status: 'active'
        };
    }

    updateUI(data) {
        document.getElementById('lastUpdate').textContent =
            new Date(data.timestamp).toLocaleTimeString();
        document.getElementById('updateCount').textContent = this.updateCount;
        document.getElementById('randomValue').textContent = data.value;

        // Add to history
        this.addToHistory(data);
    }

    addToHistory(data) {
        const history = document.getElementById('dataHistory');
        const entry = document.createElement('div');
        entry.innerHTML = `
            &lt;small&gt;${new Date(data.timestamp).toLocaleTimeString()}:
            Value = ${data.value}&lt;/small&gt;
        `;
        history.appendChild(entry);

        // Keep only last 10 entries
        while (history.children.length &gt; 10) {
            history.removeChild(history.firstChild);
        }

        // Scroll to bottom
        history.scrollTop = history.scrollHeight;
    }

    handlePollingError(error) {
        console.error('- jPulse-examples: Real-time update failed:', error);
        jPulse.UI.toast.warning('Real-time updates temporarily unavailable');
    }
}

// Usage
const realtimeManager = new RealtimeDataManager();

document.getElementById('startPollingBtn').addEventListener('click', () =&gt; {
    realtimeManager.startPolling(2000); // Update every 2 seconds
    updateButtonStates(true);
});

document.getElementById('stopPollingBtn').addEventListener('click', () =&gt; {
    realtimeManager.stopPolling();
    updateButtonStates(false);
});

function updateButtonStates(isRunning) {
    document.getElementById('startPollingBtn').disabled = isRunning;
    document.getElementById('stopPollingBtn').disabled = !isRunning;
    document.getElementById('updateStatus').textContent =
        isRunning ? '(Running)' : '(Stopped)';
    document.getElementById('updateStatus').style.color =
        isRunning ? '#28a745' : '#666';
}
&lt;/script&gt;
            </div>
        </div>

        <!-- API Best Practices -->
        <h2 class="local-heading-2">6. API Integration Best Practices</h2>
        <div class="jp-info-box">
            <h4>jPulse.api.call() Features</h4>
            <ul>
                <li>Consistent error handling across all API calls</li>
                <li>Automatic JSON parsing and response formatting</li>
                <li>Built-in support for different HTTP methods</li>
                <li>Integration with jPulse notification system</li>
                <li>Proper handling of authentication and headers</li>
            </ul>
        </div>

        <div class="jp-warning-box">
            <h4>Performance Considerations</h4>
            <ul>
                <li>Implement proper loading states for better UX</li>
                <li>Use debouncing for search/filter API calls</li>
                <li>Cache responses when appropriate</li>
                <li>Implement retry logic for transient failures</li>
                <li>Set reasonable timeouts for API calls</li>
            </ul>
        </div>

        <div class="jp-info-box">
            <h4>Security Best Practices</h4>
            <ul>
                <li>Never expose sensitive data in client-side code</li>
                <li>Validate and sanitize all user inputs</li>
                <li>Use HTTPS for all API communications</li>
                <li>Implement proper authentication and authorization</li>
                <li>Handle errors gracefully without exposing system details</li>
            </ul>
        </div>
    </div>

    <script>
        jPulse.dom.ready(() => {

            // Initialize main navigation tab row
            jPulse.UI.tabs.register(
                'jpulse-docs-examples-tabs',
                window.jPulseNavigation.tabs.jPulseDocsExamplesTabs
            );

            // Initialize examples navigation tab row
            jPulse.UI.tabs.register(
                'jpulse-examples-sub-tabs',
                window.jPulseNavigation.tabs.jPulseExamplesSubTabs
            );

            // Initialize all examples tab interfaces
            jPulse.UI.tabs.register('basic-api-tabs', {
                tabs: [
                    { id: 'basic-api-example-tab', label: 'Example', panelId: 'basic-api-example-panel' },
                    { id: 'basic-api-source-tab', label: 'Source Code', panelId: 'basic-api-source-panel' }
                ],
                panelHeight: '30rem',
                slideAnimation: true
            }, 'basic-api-example-tab');

            jPulse.UI.tabs.register('loading-states-tabs', {
                tabs: [
                    { id: 'loading-states-example-tab', label: 'Example', panelId: 'loading-states-example-panel' },
                    { id: 'loading-states-source-tab', label: 'Source Code', panelId: 'loading-states-source-panel' }
                ],
                panelHeight: '34rem',
                slideAnimation: true
            }, 'loading-states-example-tab');

            jPulse.UI.tabs.register('form-submission-tabs', {
                tabs: [
                    { id: 'form-submission-example-tab', label: 'Example', panelId: 'form-submission-example-panel' },
                    { id: 'form-submission-source-tab', label: 'Source Code', panelId: 'form-submission-source-panel' }
                ],
                panelHeight: '37rem',
                slideAnimation: true
            }, 'form-submission-example-tab');

            jPulse.UI.tabs.register('error-handling-tabs', {
                tabs: [
                    { id: 'error-handling-example-tab', label: 'Example', panelId: 'error-handling-example-panel' },
                    { id: 'error-handling-source-tab', label: 'Source Code', panelId: 'error-handling-source-panel' }
                ],
                panelHeight: '34rem',
                slideAnimation: true
            }, 'error-handling-example-tab');

            jPulse.UI.tabs.register('realtime-tabs', {
                tabs: [
                    { id: 'realtime-example-tab', label: 'Example', panelId: 'realtime-example-panel' },
                    { id: 'realtime-source-tab', label: 'Source Code', panelId: 'realtime-source-panel' }
                ],
                panelHeight: '37rem',
                slideAnimation: true
            }, 'realtime-example-tab');

            // Basic API call example
            document.getElementById('testApiBtn').addEventListener('click', async () => {
                const responseDiv = document.getElementById('apiResponse');
                const responseContent = document.getElementById('apiResponseContent');
                try {
                    const response = await jPulse.api.call('/api/1/health/status', 'GET');
                    responseDiv.classList.remove('jp-hidden', 'jp-output-error');
                    responseDiv.classList.add('jp-output-success');
                    responseContent.textContent = JSON.stringify(response, null, 2);
                    if (response.success) {
                        jPulse.UI.toast.success('API call successful!');
                    } else {
                        responseDiv.classList.remove('jp-output-success');
                        responseDiv.classList.add('jp-output-error');
                        jPulse.UI.toast.error('API returned an error: ' + response.error);
                    }
                } catch (error) {
                    responseDiv.classList.remove('jp-hidden', 'jp-output-success');
                    responseDiv.classList.add('jp-output-error');
                    responseContent.textContent = `Error: ${error.message}`;
                    jPulse.UI.toast.error('API call failed: ' + error.message);
                }
            });

            // Error handling test
            document.getElementById('testErrorBtn').addEventListener('click', async () => {
                const responseDiv = document.getElementById('apiResponse');
                const responseContent = document.getElementById('apiResponseContent');
                try {
                    const response = await jPulse.api.call('/api/1/does-no-exist', 'GET');
                    responseDiv.classList.remove('jp-hidden', 'jp-output-error');
                    responseDiv.classList.add('jp-output-success');
                    responseContent.textContent = JSON.stringify(response, null, 2);
                    if (response.success) {
                        jPulse.UI.toast.success('API call successful!');
                    } else {
                        responseDiv.classList.remove('jp-output-success');
                        responseDiv.classList.add('jp-output-error');
                        jPulse.UI.toast.error('API returned an error: ' + response.error);
                    }
                } catch (error) {
                    responseDiv.classList.remove('jp-hidden', 'jp-output-success');
                    responseDiv.classList.add('jp-output-error');
                    responseContent.textContent = `Error: ${error.message}`;
                    jPulse.UI.toast.error('API call failed: ' + error.message);
                }
            });

            // Loading states example
            document.getElementById('loadingTestBtn').addEventListener('click', async () => {
                const btn = document.getElementById('loadingTestBtn');
                const btnText = btn.querySelector('.btn-text');
                const btnLoading = btn.querySelector('.btn-loading');
                const spinner = document.getElementById('loadingSpinner');
                const content = document.getElementById('loadingContent');
                const list = document.getElementById('loadedList');

                // Show loading state
                btn.disabled = true;
                btnText.style.display = 'none';
                btnLoading.classList.remove('jp-hidden');
                spinner.classList.remove('jp-hidden');
                content.classList.add('jp-hidden');

                try {
                    // Simulate API delay
                    await new Promise(resolve => setTimeout(resolve, 3000));

                    // Simulate data
                    const items = [
                        'Dynamic content item 1',
                        'Dynamic content item 2',
                        'Dynamic content item 3',
                        `Loaded at ${new Date().toLocaleTimeString()}`
                    ];

                    // Populate content
                    list.innerHTML = items.map(item => `<li>${item}</li>`).join('');

                    // Show content
                    spinner.classList.add('jp-hidden');
                    content.classList.remove('jp-hidden');

                    jPulse.UI.toast.success('Data loaded successfully! üìä');
                } catch (error) {
                    spinner.classList.add('jp-hidden');
                    jPulse.UI.toast.error('Failed to load data: ' + error.message);
                } finally {
                    // Reset button
                    btn.disabled = false;
                    btnText.style.display = 'inline';
                    btnLoading.classList.add('jp-hidden');
                }
            });

            // Form submission example
            document.getElementById('apiForm').addEventListener('submit', async (e) => {
                e.preventDefault();

                const submitBtn = document.getElementById('submitBtn');
                const submitText = submitBtn.querySelector('.submit-text');
                const submitLoading = submitBtn.querySelector('.submit-loading');
                const resultDiv = document.getElementById('submissionResult');
                const resultData = document.getElementById('submissionData');

                // Show loading
                submitBtn.disabled = true;
                submitText.style.display = 'none';
                submitLoading.classList.remove('jp-hidden');

                try {
                    // Collect form data
                    const formData = new FormData(e.target);
                    const data = Object.fromEntries(formData.entries());

                    // NOTE: This is a demonstration - the /api/1/contact endpoint doesn't exist
                    // In a real application, you would implement this endpoint

                    // Simulate API call with realistic delay
                    await new Promise(resolve => setTimeout(resolve, 2000));

                    // Simulate a realistic response (mocked for demonstration)
                    const response = {
                        success: true,
                        message: 'Contact form submitted successfully (DEMO)',
                        data: {
                            ...data,
                            id: Math.floor(Math.random() * 10000),
                            status: 'received'
                        },
                        timestamp: new Date().toISOString(),
                        note: 'This is a mocked response for demonstration purposes'
                    };

                    // Show result
                    resultDiv.classList.remove('jp-hidden');
                    resultData.textContent = JSON.stringify(response, null, 2);

                    jPulse.UI.toast.success('Form submitted successfully! üìß (Demo mode)');
                    e.target.reset();
                } catch (error) {
                    jPulse.UI.toast.error('Submission failed: ' + error.message);
                } finally {
                    // Reset button
                    submitBtn.disabled = false;
                    submitText.style.display = 'inline';
                    submitLoading.classList.add('jp-hidden');
                }
            });

            // Error handling examples
            const errorButtons = {
                'test404Btn': () => simulateError('NOT_FOUND', 'Resource not found (404)'),
                'test500Btn': () => simulateError('SERVER_ERROR', 'Internal server error (500)'),
                'testNetworkBtn': () => simulateError('NETWORK_ERROR', 'Network connection failed'),
                'testTimeoutBtn': () => simulateError('TIMEOUT_ERROR', 'Request timed out')
            };

            Object.entries(errorButtons).forEach(([btnId, errorFn]) => {
                document.getElementById(btnId).addEventListener('click', errorFn);
            });

            function simulateError(errorType, message) {
                const errorDiv = document.getElementById('errorDetails');
                const errorContent = document.getElementById('errorContent');

                const errorInfo = {
                    type: errorType,
                    message: message,
                    timestamp: new Date().toISOString(),
                    userAgent: navigator.userAgent,
                    url: window.location.href
                };

                errorDiv.classList.remove('jp-hidden');
                errorContent.textContent = JSON.stringify(errorInfo, null, 2);

                jPulse.UI.toast.error(`Simulated ${errorType}: ${message}`);
            }

            // Real-time updates
            let pollingInterval = null;
            let updateCount = 0;

            document.getElementById('startPollingBtn').addEventListener('click', () => {
                if (pollingInterval) clearInterval(pollingInterval);

                pollingInterval = setInterval(updateRealtimeData, 2000);
                updateRealtimeData(); // Initial update

                document.getElementById('startPollingBtn').disabled = true;
                document.getElementById('stopPollingBtn').disabled = false;
                document.getElementById('updateStatus').textContent = '(Running)';
                document.getElementById('updateStatus').classList.remove('jp-text-secondary');
                document.getElementById('updateStatus').classList.add('jp-text-success');

                jPulse.UI.toast.info('Real-time updates started üîÑ');
            });

            document.getElementById('stopPollingBtn').addEventListener('click', () => {
                if (pollingInterval) {
                    clearInterval(pollingInterval);
                    pollingInterval = null;
                }

                document.getElementById('startPollingBtn').disabled = false;
                document.getElementById('stopPollingBtn').disabled = true;
                document.getElementById('updateStatus').textContent = '(Stopped)';
                document.getElementById('updateStatus').classList.remove('jp-text-success');
                document.getElementById('updateStatus').classList.add('jp-text-secondary');

                jPulse.UI.toast.info('Real-time updates stopped ‚èπÔ∏è');
            });

            function updateRealtimeData() {
                updateCount++;
                const now = new Date();
                const randomValue = Math.floor(Math.random() * 1000);

                document.getElementById('lastUpdate').textContent = now.toLocaleTimeString();
                document.getElementById('updateCount').textContent = updateCount;
                document.getElementById('randomValue').textContent = randomValue;

                // Add to history
                const history = document.getElementById('dataHistory');
                const entry = document.createElement('div');
                entry.innerHTML = `<small>${now.toLocaleTimeString()}: Value = ${randomValue}</small>`;
                history.appendChild(entry);

                // Keep only last 10 entries
                while (history.children.length > 10) {
                    history.removeChild(history.firstChild);
                }

                history.scrollTop = history.scrollHeight;
            }
        });
    </script>

    <style>
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>

    {{file.include "jpulse-footer.tmpl"}}
</body>
</html>
